# シフト除外時間管理機能 実装指示書

---

## 概要

既存のシフト管理システム（Flask＋CSVベース）に、
「休憩」「デスクワーク」などオペレーションに直接関わらない時間帯を管理し、
グラフや人数集計から除外できる機能を追加したい。

---

## 要件

### 1. 除外時間帯データの管理
- 月ごとに `data/exclude_time/exclude_time_YYYY-MM.csv` というファイルを作成
- カラムは `date,start,end,category,name`
  - 例:
    ```csv
    2025-07-12,14:00,15:00,break,山田太郎
    2025-07-12,15:00,17:00,desk,山田太郎
    ```

### 2. 管理画面
- 管理者のみがアクセスできる「除外時間帯管理」画面を新規作成
- 月を選択し、その月の除外時間帯データを追加・編集・削除できる
  - 入力項目：日付、開始時刻、終了時刻、区分（休憩/デスクワーク等）、名前

### 3. シフト表UI
- 各日の「シフトメモ」欄の上下どちらかに、その日の除外者リスト（時間帯・区分・名前）をテキストで表示

### 4. 人数グラフ・人構成表示
- グラフや人数集計時に、除外時間帯に該当する人を人数カウントから除外
- 人構成表示では、各カテゴリー（通常勤務・休憩・デスクワーク等）ごとに人名リストを表示

---

## 補足

- 既存のシフトCSVやUIは変更しない
- 除外時間帯データは別管理
- 既存のシフト集計・グラフロジックを拡張して対応

---

## 実装の流れ（例）

1. `data/exclude_time/` フォルダと月別CSVの用意
2. 管理者用の除外時間帯管理画面（Flaskルート＋テンプレート）作成
3. シフト表テンプレートの修正（除外者リスト表示）
4. グラフ・集計ロジックの修正（除外者をカウントから除外）

---

**この要件で実装を進めてください。質問や追加要望があれば随時聞いてください。** 